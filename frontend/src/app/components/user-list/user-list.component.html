<router-outlet></router-outlet>
<mat-card>
  <mat-card-header>
    <mat-card-title>Usuarios</mat-card-title>
    <mat-card-subtitle>Aquí encontrarás la información sobre todos los usuarios</mat-card-subtitle>
  </mat-card-header>

  <button class="fab-button" mat-fab extended color="primary" [routerLink]="'./new'" routerLinkActive>
    <mat-icon>add</mat-icon>
    Añadir usuario
  </button>

  <mat-card-content>
    <br>
    <div class="table-search-container">
      <div class="search-bar">
        <mat-icon>search</mat-icon>
        <input type="search" placeholder="Buscar usuarios..." matInput #search (keyup)="applyFilter(search.value)">
      </div>
      <mat-form-field>
        <mat-label>Filtro por estado</mat-label>
        <mat-select (selectionChange)="applyFilterByStatus($event.value)">
          <mat-option value="all">Todos</mat-option>
          <mat-option value="enabled">Activos</mat-option>
          <mat-option value="disabled">Inactivos</mat-option>
        </mat-select>
      </mat-form-field>
    </div>


    <mat-divider></mat-divider>

    <table mat-table class="full-width-table" matSort aria-label="Elements">
      <!-- Id Column -->
      <ng-container matColumnDef="id">
        <th>
          <mat-header-cell *matHeaderCellDef mat-sort-header>#</mat-header-cell>
        </th>
        <td>
          <mat-cell *matCellDef="let user">{{ user.id }}</mat-cell>
        </td>
      </ng-container>

      <!-- Name Column -->
      <ng-container matColumnDef="name">
        <th>
          <mat-header-cell *matHeaderCellDef mat-sort-header>Apodo</mat-header-cell>
        </th>
        <td>
          <mat-cell *matCellDef="let user">{{ user.name }}</mat-cell>
        </td>
      </ng-container>

      <ng-container matColumnDef="names">
        <th>
          <mat-header-cell *matHeaderCellDef mat-sort-header>Nombre y Apellidos</mat-header-cell>
        </th>
        <td>
          <mat-cell *matCellDef="let user">{{ user.firstName }} {{ user.lastName }}</mat-cell>
        </td>
      </ng-container>

      <ng-container matColumnDef="email">
        <th>
          <mat-header-cell *matHeaderCellDef mat-sort-header>Email</mat-header-cell>
        </th>
        <td>
          <mat-cell *matCellDef="let user">{{ user.email }}</mat-cell>
        </td>
      </ng-container>


      <ng-container matColumnDef="createdAt">
        <th>
          <mat-header-cell *matHeaderCellDef mat-sort-header>Fecha de creación</mat-header-cell>
        </th>
        <td>
          <mat-cell *matCellDef="let user">{{ getDate(user.createdAt) }}</mat-cell>
        </td>
      </ng-container>

      <ng-container matColumnDef="updatedAt">
        <th>
          <mat-header-cell *matHeaderCellDef mat-sort-header>Fecha de actualización</mat-header-cell>
        </th>
        <td>
          <mat-cell *matCellDef="let user">{{ getDate(user.updatedAt) }}</mat-cell>
        </td>
      </ng-container>


      <ng-container matColumnDef="status">
        <th>
          <mat-header-cell *matHeaderCellDef mat-sort-header disabled="true">Estado</mat-header-cell>
        </th>
        <td>
          <mat-cell *matCellDef="let user">
            <app-user-status-component [status]="user.enabled"></app-user-status-component>
          </mat-cell>
        </td>
      </ng-container>


      <ng-container matColumnDef="actions">
        <th>
          <mat-header-cell *matHeaderCellDef mat-sort-header [disabled]="true">Acciones</mat-header-cell>
        </th>
        <td>
          <mat-cell *matCellDef="let user">
            <div id="actions_container">
              <button mat-stroked-button class="ic_action" matTooltip="Editar perfil"
                      [routerLink]="['./', user.id, 'edit']">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="w-4 h-4"
                >
                  <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path>
                  <circle cx="12" cy="12" r="3"></circle>
                </svg>
              </button>
              <button mat-stroked-button class="ic_action" matTooltip="Vehiculos"
                      [routerLink]="['./', user.id, 'vehicles'] ">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="w-4 h-4"
                >
                  <path
                    d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"></path>
                  <circle cx="7" cy="17" r="2"></circle>
                  <path d="M9 17h6"></path>
                  <circle cx="17" cy="17" r="2"></circle>
                </svg>
              </button>
              <button mat-stroked-button class="ic_action" matTooltip="Recargas"
                      [routerLink]="['./', user.id, 'recharges']">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="w-4 h-4"
                >
                  <rect width="16" height="10" x="2" y="7" rx="2" ry="2"></rect>
                  <line x1="22" x2="22" y1="11" y2="13"></line>
                </svg>
              </button>
              <button mat-stroked-button class="ic_action" matTooltip="Borrar" (click)="requestDeleteUser(user.id)">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M3 6h18"></path>
                  <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                  <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                </svg>
              </button>
            </div>
          </mat-cell>
        </td>
      </ng-container>

      <tr>
        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      </tr>
      <tr>
        <mat-row mat-ripple *matRowDef="let user; columns: displayedColumns;"></mat-row>
      </tr>
    </table>
    <mat-paginator #paginator
                   [length]="dataSource.data.length"
                   [pageIndex]="0"
                   [pageSize]="20"
                   [pageSizeOptions]="[5, 10, 20, 50]"
                   aria-label="Select page">
    </mat-paginator>
  </mat-card-content>

  <mat-card-footer>
    <mat-progress-bar mode="indeterminate" *ngIf="isLoadingResults">
    </mat-progress-bar>
  </mat-card-footer>
</mat-card>
